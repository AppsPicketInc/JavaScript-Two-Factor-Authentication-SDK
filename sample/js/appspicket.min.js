AppsPicket=function(a){this.init(a)};const P_1024=bigInt("E0A67598CD1B763BC98C8ABB333E5DDA0CD3AA0E5E1FB5BA8A7B4EABC10BA338FAE06DD4B90FDA70D7CF0CB0C638BE3341BEC0AF8A7330A3307DED2299A0EE606DF035177A239C34A912C202AA5F83B9C4A7CF0235B5316BFC6EFB9A248411258B30B839AF172440F32563056CB67A861158DDD90E6A894C72A5BBEF9E286C6B",16),Q_1024=bigInt("E950511EAB424B9A19A2AEB4E159B7844C589C4F",16),G_1024=bigInt("D29D5121B0423C2769AB21843E5A3240FF19CACC792264E3BB6BE4F78EDD1B15C4DFF7F1D905431F0AB16790E1F773B5CE01C804E509066A9919F5195F4ABC58189FD9FF987389CB5BEDF21B4DAB4F8B76A055FFE2770988FE2EC2DE11AD92219F0B351869AC24DA3D7BA87011A701CE8EE7BFE49486ED4527B7186CA4610A75",16);$.extend(AppsPicket.prototype,{init:function(a){this.url=a},login:function(a,b,c){var d=bigInt.randBetween(bigInt(0),Q_1024),e=G_1024.modPow(d,P_1024),f=localStorage.getItem("deviceId");localStorage.setItem("l",d.toString()),localStorage.setItem("com",e.toString()),a.Com=e.toString(),a.step="step1",a.deviceId=f,$.ajax({url:this.url,type:"POST",data:a,dataType:"json",cache:!1}).done(function(d,e,g){if("error"in d)c(d);else{$.each(d.values,function(a,b){localStorage.setItem(b.name,b.val)});var h=bigInt(localStorage.getItem("k1")),i=bigInt(localStorage.getItem("l")),j=bigInt(localStorage.getItem("ch")),k=bigInt(md5(a.password),16),l=h.multiply(k).mod(Q_1024),m=i.add(j.multiply(l.toString())).mod(Q_1024),n={uname:a.uname,step:"step2",s:m.toString(),deviceId:f};$.ajax({url:this.url,type:"POST",data:n,dataType:"json",cache:!1}).done(function(a,d,e){"error"in a?c(a):(localStorage.setItem("uname",n.uname),b(a))}).fail(function(a,b,d){c(d)})}}).fail(function(a,b,d){c(d)})},signUp:function(a,b,c){var d=bigInt(md5(a.password),16),e=bigInt.randBetween(bigInt(0),Q_1024),f=e.multiply(d).mod(Q_1024),g=G_1024.modPow(f,P_1024),h=g.toString();a.PK=g.toString(),a.step="signup",a.deviceId=h,localStorage.clear(),$.ajax({url:this.url,type:"POST",data:a,dataType:"json",cache:!1}).done(function(d,f,g){"error"in d?c(d):(localStorage.setItem("user_id",d.user_id),localStorage.setItem("k1",e.toString()),localStorage.setItem("uname",a.uname),b(d))}).fail(function(a,b,d){return c(d)})},confirmOtp:function(a,b,c){var d=localStorage.getItem("user_id"),e=localStorage.getItem("uname"),f={};f.user_id=d,f.uname=e,f.otp=a,f.step="confirm-otp",$.ajax({url:this.url,type:"POST",data:f,dataType:"json",cache:!1}).done(function(a,d,e){"error"in a?c(a):(localStorage.setItem("deviceId",a.device_id),b(a))}).fail(function(a,b,d){return c(d)})}});